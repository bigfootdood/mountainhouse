<html>
	<head>
		<title>My first three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script src="js/three.min.js"></script>
    <script src="js/GLTFLoader.js"></script>
    <script src="js/OBJLoader.js"></script>
    <script src="js/OrbitControls.js"></script>
		<script>

      //Setup Scene
			var scene = new THREE.Scene();
      scene.background = new THREE.Color( 0x7EC0EE);

      //Starter Camera
      var camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 10000 );

      //Orbit Controls
      var controls = new THREE.OrbitControls( camera );

      //controls.update() must be called after any manual changes to the camera's transform
      camera.position.set( 0, 0, 5);
      controls.update();

			var renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );



			var geometry = new THREE.BoxGeometry( .2, .2, .2 );
			var material = new THREE.MeshBasicMaterial( { color: 0x808080 } );
			var cube = new THREE.Mesh( geometry, material );
			scene.add( cube );
      cube.position.set(0,-.5,1);

      //Lighting
      var light = new THREE.DirectionalLight( 0x404040 ); // soft white light
      light.intensity = 4.5;
      light.position.set(-20,30,10)
      scene.add( light );

      var light2 = new THREE.SpotLight( 0x404040 ); // soft white light
      light2.intensity = 3;
      light2.position.set(-3,-30,-10)
      scene.add( light2 );

      var light3 = new THREE.AmbientLight( 0x404040 ); // soft white light
      light3.intensity = 1;
      scene.add( light3 );


      // Load Snow Island
      var loader = new THREE.GLTFLoader();
      loader.load(
      	// resource URL
      	'assets/island-gltf/WinterIslandv2.glb',
      	// called when the resource is loaded
      	function ( gltf ) {

          gltf.scene.scale.set(0.3,0.3,0.3);
          gltf.scene.position.set(0,-2,0);
      		scene.add( gltf.scene );
      	},
      	// called while loading is progressing
      	function ( xhr ) {

      		console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );

      	},
      	// called when loading has errors
      	function ( error ) {
      		console.log( 'An error happened' );

      	}
      );

      var raycaster = new THREE.Raycaster();
      var mouse = new THREE.Vector2();

      function onMouseMove( event ) {

      	// calculate mouse position in normalized device coordinates
      	// (-1 to +1) for both components

      	mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
      	mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

      }

			var animate = function () {
				requestAnimationFrame( animate );


      	// update the picking ray with the camera and mouse position
      	raycaster.setFromCamera( mouse, camera );

      	// calculate objects intersecting the picking ray
      	var intersects = raycaster.intersectObjects( scene.children );

        if(intersects.length>0){
          // intersects[0].object.material.color.set(0xff0000);
          intersects[0].object.scale.set(1.5,1.5,1.5);

        }else{
					//this wont work with multiple objects!
          cube.material.color.set(0x808080);
          cube.scale.set(1,1,1)
        }
        // cube.scale.set(1,1,1);




				// cube.rotation.x += 0.01;
				// cube.rotation.y += 0.01;
        controls.update();

				renderer.render( scene, camera );
			};
      window.addEventListener( 'mousemove', onMouseMove, false );

      window.requestAnimationFrame(animate);

			// animate();
		</script>
	</body>
</html>
